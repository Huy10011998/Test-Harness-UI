{"ast":null,"code":"var _jsxFileName = \"/Users/quochuy/Downloads/Project-Demo/Test-harness-ui/src/hooks/with-auth.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useReducer, useMemo } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport jwt_decode from \"jwt-decode\";\nimport { Loading } from \"../components/loading\";\nimport { getLoading } from \"../redux/loading\";\nimport { models, reducers } from \"../services\";\nimport { storage } from \"../common/utils\";\nimport { types } from \"../services\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport const initReducerState = {\n  login: models.login,\n  package: models.package,\n  one: models.one\n};\nconst AuthContext = /*#__PURE__*/React.createContext(\"\");\nconst AuthProvider = props => {\n  _s();\n  const localStorage = storage();\n  const loading = useSelector(getLoading).requestId;\n  const [state, dispatch] = useReducer(reducers, initReducerState);\n  const isLoading = useMemo(() => {\n    if (loading) {\n      return true;\n    }\n    return false;\n  }, [loading]);\n\n  // enter while first loaded\n  useEffect(() => {\n    const token = localStorage.getToken();\n    if (token) {\n      localStorage.setTokenIntoHeaders(token);\n      const decode = jwt_decode(token);\n      dispatch({\n        type: types.LOGIN,\n        payload: {\n          token: token,\n          userData: decode\n        }\n      });\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  // enter while logged successfully\n  useEffect(() => {\n    const {\n      login: {\n        token\n      }\n    } = state;\n    if (token) {\n      localStorage.setTokenIntoHeaders(token);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [state.login]);\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      dispatch,\n      state\n    },\n    children: [isLoading ? /*#__PURE__*/_jsxDEV(Loading, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 20\n    }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {}, void 0, false), props.children]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 60,\n    columnNumber: 5\n  }, this);\n};\n_s(AuthProvider, \"7XCC+r2zLWij8A7OHVKZ8gwbtqs=\", false, function () {\n  return [useSelector];\n});\n_c = AuthProvider;\nexport { AuthContext, AuthProvider };\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["React","useEffect","useReducer","useMemo","useSelector","jwt_decode","Loading","getLoading","models","reducers","storage","types","jsxDEV","_jsxDEV","Fragment","_Fragment","initReducerState","login","package","one","AuthContext","createContext","AuthProvider","props","_s","localStorage","loading","requestId","state","dispatch","isLoading","token","getToken","setTokenIntoHeaders","decode","type","LOGIN","payload","userData","Provider","value","children","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/Users/quochuy/Downloads/Project-Demo/Test-harness-ui/src/hooks/with-auth.jsx"],"sourcesContent":["import React, { useEffect, useReducer, useMemo } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport jwt_decode from \"jwt-decode\";\nimport { Loading } from \"../components/loading\";\nimport { getLoading } from \"../redux/loading\";\nimport { models, reducers } from \"../services\";\nimport { storage } from \"../common/utils\";\nimport { types } from \"../services\";\n\nexport const initReducerState = {\n  login: models.login,\n  package: models.package,\n  one: models.one,\n};\n\nconst AuthContext = React.createContext(\"\");\n\nconst AuthProvider = (props) => {\n  const localStorage = storage();\n  const loading = useSelector(getLoading).requestId;\n\n  const [state, dispatch] = useReducer(reducers, initReducerState);\n\n  const isLoading = useMemo(() => {\n    if (loading) {\n      return true;\n    }\n    return false;\n  }, [loading]);\n\n  // enter while first loaded\n  useEffect(() => {\n    const token = localStorage.getToken();\n    if (token) {\n      localStorage.setTokenIntoHeaders(token);\n      const decode = jwt_decode(token);\n      dispatch({\n        type: types.LOGIN,\n        payload: {\n          token: token,\n          userData: decode,\n        },\n      });\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  // enter while logged successfully\n  useEffect(() => {\n    const {\n      login: { token },\n    } = state;\n    if (token) {\n      localStorage.setTokenIntoHeaders(token);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [state.login]);\n\n  return (\n    <AuthContext.Provider\n      value={{\n        dispatch,\n        state,\n      }}\n    >\n      {isLoading ? <Loading /> : <></>}\n      {props.children}\n    </AuthContext.Provider>\n  );\n};\n\nexport { AuthContext, AuthProvider };\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,UAAU,EAAEC,OAAO,QAAQ,OAAO;AAC7D,SAASC,WAAW,QAAQ,aAAa;AACzC,OAAOC,UAAU,MAAM,YAAY;AACnC,SAASC,OAAO,QAAQ,uBAAuB;AAC/C,SAASC,UAAU,QAAQ,kBAAkB;AAC7C,SAASC,MAAM,EAAEC,QAAQ,QAAQ,aAAa;AAC9C,SAASC,OAAO,QAAQ,iBAAiB;AACzC,SAASC,KAAK,QAAQ,aAAa;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAAA,SAAAC,QAAA,IAAAC,SAAA;AAEpC,OAAO,MAAMC,gBAAgB,GAAG;EAC9BC,KAAK,EAAET,MAAM,CAACS,KAAK;EACnBC,OAAO,EAAEV,MAAM,CAACU,OAAO;EACvBC,GAAG,EAAEX,MAAM,CAACW;AACd,CAAC;AAED,MAAMC,WAAW,gBAAGpB,KAAK,CAACqB,aAAa,CAAC,EAAE,CAAC;AAE3C,MAAMC,YAAY,GAAIC,KAAK,IAAK;EAAAC,EAAA;EAC9B,MAAMC,YAAY,GAAGf,OAAO,CAAC,CAAC;EAC9B,MAAMgB,OAAO,GAAGtB,WAAW,CAACG,UAAU,CAAC,CAACoB,SAAS;EAEjD,MAAM,CAACC,KAAK,EAAEC,QAAQ,CAAC,GAAG3B,UAAU,CAACO,QAAQ,EAAEO,gBAAgB,CAAC;EAEhE,MAAMc,SAAS,GAAG3B,OAAO,CAAC,MAAM;IAC9B,IAAIuB,OAAO,EAAE;MACX,OAAO,IAAI;IACb;IACA,OAAO,KAAK;EACd,CAAC,EAAE,CAACA,OAAO,CAAC,CAAC;;EAEb;EACAzB,SAAS,CAAC,MAAM;IACd,MAAM8B,KAAK,GAAGN,YAAY,CAACO,QAAQ,CAAC,CAAC;IACrC,IAAID,KAAK,EAAE;MACTN,YAAY,CAACQ,mBAAmB,CAACF,KAAK,CAAC;MACvC,MAAMG,MAAM,GAAG7B,UAAU,CAAC0B,KAAK,CAAC;MAChCF,QAAQ,CAAC;QACPM,IAAI,EAAExB,KAAK,CAACyB,KAAK;QACjBC,OAAO,EAAE;UACPN,KAAK,EAAEA,KAAK;UACZO,QAAQ,EAAEJ;QACZ;MACF,CAAC,CAAC;IACJ;IACA;EACF,CAAC,EAAE,EAAE,CAAC;;EAEN;EACAjC,SAAS,CAAC,MAAM;IACd,MAAM;MACJgB,KAAK,EAAE;QAAEc;MAAM;IACjB,CAAC,GAAGH,KAAK;IACT,IAAIG,KAAK,EAAE;MACTN,YAAY,CAACQ,mBAAmB,CAACF,KAAK,CAAC;IACzC;IACA;EACF,CAAC,EAAE,CAACH,KAAK,CAACX,KAAK,CAAC,CAAC;EAEjB,oBACEJ,OAAA,CAACO,WAAW,CAACmB,QAAQ;IACnBC,KAAK,EAAE;MACLX,QAAQ;MACRD;IACF,CAAE;IAAAa,QAAA,GAEDX,SAAS,gBAAGjB,OAAA,CAACP,OAAO;MAAAoC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC,gBAAGhC,OAAA,CAAAE,SAAA,mBAAI,CAAC,EAC/BQ,KAAK,CAACkB,QAAQ;EAAA;IAAAC,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACK,CAAC;AAE3B,CAAC;AAACrB,EAAA,CApDIF,YAAY;EAAA,QAEAlB,WAAW;AAAA;AAAA0C,EAAA,GAFvBxB,YAAY;AAsDlB,SAASF,WAAW,EAAEE,YAAY;AAAG,IAAAwB,EAAA;AAAAC,YAAA,CAAAD,EAAA"},"metadata":{},"sourceType":"module"}